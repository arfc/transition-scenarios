
<simulation xmlns:xi="http://www.w3.org/2001/XInclude">
  <control>
    <duration>1764</duration>
    <startmonth>5</startmonth>
    <startyear>2013</startyear>
    <decay>lazy</decay>
  </control>

  <archetypes>
    <spec>
      <lib>cycamore</lib>
      <name>Source</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Sink</name>
    </spec>
    <spec>
        <lib>cycamore</lib>
        <name>Reactor</name>
    </spec>
    <spec>
      <lib>agents</lib>
      <name>NullRegion</name>
    </spec>
    <spec>
      <lib>agents</lib>
      <name>NullInst</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Separations</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>DeployInst</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Separations</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Enrichment</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Mixer</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Storage</name>
    </spec>
    <spec>
      <lib>saltproc_reactor.saltproc_reactor</lib>
      <name>saltproc_reactor</name>
    </spec>
  </archetypes>




<!-- La Hague Model from Schneider & Marignac -->
  <facility>
    <name>reprocessing</name>
    <config>
      <Separations>
         <feed_commods>   <val>cooled_uox</val> <val>pre_2013_unf</val> </feed_commods>
         <feed_recipe>uox_used_fuel_recipe</feed_recipe>
         <feedbuf_size>1e100</feedbuf_size>
         <!-- 1100 tons/year 91.6 tons/timestep -->
         <throughput>1e100</throughput>
         <leftover_commod>reprocess_waste</leftover_commod>
         <leftoverbuf_size>1e100</leftoverbuf_size>
         <streams>
          <item>
            <commod>lwr_pu</commod>
            <info>
              <buf_size>1e100</buf_size>
              <efficiencies>
                <item>
                  <comp>Pu</comp> <eff>.99</eff>
                </item>
                </efficiencies>
            </info>
          </item>
          <item>
            <commod>lwr_u</commod>
            <info>
              <buf_size>1e100</buf_size>
              <efficiencies>
                <item>
                  <comp>U</comp> <eff>.99</eff>
                </item>
                </efficiencies>
            </info>
          </item>
          <item>
            <commod>lwr_np</commod>
            <info>
              <buf_size>1e100</buf_size>
              <efficiencies>
                <item>
                  <comp>Np</comp> <eff>.99</eff>
                </item>
                </efficiencies>
            </info>
          </item>
          <item>
            <commod>lwr_am</commod>
            <info>
              <buf_size>1e100</buf_size>
              <efficiencies>
                <item>
                  <comp>Am</comp> <eff>.99</eff>
                </item>
                </efficiencies>
            </info>
          </item>
          <item>
            <commod>lwr_cm</commod>
            <info>
              <buf_size>1e100</buf_size>
              <efficiencies>
                <item>
                  <comp>Cm</comp> <eff>.99</eff>
                </item>
                </efficiencies>
            </info>
          </item>
        </streams>
      </Separations>
    </config>
  </facility>



<!-- La Hague Model from Schneider & Marignac -->
<facility>
  <name>salt_reprocessing</name>
  <config>
    <Separations>
      <feed_commods>
        <val>fuel_out</val>
      </feed_commods>
      <feed_recipe>init_salt_recipe</feed_recipe>
      <feedbuf_size>1e100</feedbuf_size>
      <!-- 1100 tons/year 91.6 tons/timestep -->
      <throughput>1e100</throughput>
      <leftover_commod>salt_reprocess_waste</leftover_commod>
      <leftoverbuf_size>1e100</leftoverbuf_size>
      <streams>
        <item>
          <commod>salt_pu</commod>
          <info>
            <buf_size>1e100</buf_size>
            <efficiencies>
              <item>
                <comp>Pu</comp>
                <eff>.99</eff>
              </item>
            </efficiencies>
          </info>
        </item>
        <item>
          <commod>salt_u</commod>
          <info>
            <buf_size>1e100</buf_size>
            <efficiencies>
              <item>
                <comp>U</comp>
                <eff>.99</eff>
              </item>
            </efficiencies>
          </info>
        </item>
        <item>
          <commod>salt_np</commod>
          <info>
            <buf_size>1e100</buf_size>
            <efficiencies>
              <item>
                <comp>Np</comp>
                <eff>.99</eff>
              </item>
            </efficiencies>
          </info>
        </item>
        <item>
          <commod>salt_am</commod>
          <info>
            <buf_size>1e100</buf_size>
            <efficiencies>
              <item>
                <comp>Am</comp>
                <eff>.99</eff>
              </item>
            </efficiencies>
          </info>
        </item>
        <item>
          <commod>salt_cm</commod>
          <info>
            <buf_size>1e100</buf_size>
            <efficiencies>
              <item>
                <comp>Cm</comp>
                <eff>.99</eff>
              </item>
            </efficiencies>
          </info>
        </item>
        <item>
          <commod>salt_na</commod>
          <info>
            <buf_size>1e100</buf_size>
            <efficiencies>
              <item>
                <comp>Na</comp>
                <eff>.99</eff>
              </item>
            </efficiencies>
          </info>
        </item>
        <item>
          <commod>salt_cl</commod>
          <info>
            <buf_size>1e100</buf_size>
            <efficiencies>
              <item>
                <comp>Cl</comp>
                <eff>.99</eff>
              </item>
            </efficiencies>
          </info>
        </item>
      </streams>
    </Separations>
  </config>
</facility>



<!-- Infinite UOX_Pu to MOX mixer -->
<facility>
    <name>rebus_fuel_fab_lwr</name>
    <config>
      <Mixer>
        <in_streams>
          <stream>
            <info>
              <mixing_ratio>0.067524083</mixing_ratio>
              <buf_size>1e100</buf_size>
            </info>
            <commodities>
              <item>
                <commodity>na</commodity>
                <pref>1.0</pref>
              </item>
              <item>
                <commodity>salt_na</commodity>
                <pref>2.0</pref>
              </item>
            </commodities>
          </stream>
          <stream>
            <info>
              <mixing_ratio>0.359795664</mixing_ratio>
              <buf_size>1e100</buf_size>
            </info>
            <commodities>
              <item>
                <commodity>cl</commodity>
                <pref>1.0</pref>
              </item>
              <item>
                <commodity>salt_cl</commodity>
                <pref>2.0</pref>
              </item>
            </commodities>
          </stream>
          <stream>
            <info>
              <mixing_ratio>0.477050824</mixing_ratio>
              <buf_size>1e100</buf_size>
            </info>
            <commodities>
              <item>
                <commodity>dep_u</commodity>
                <pref>1.0</pref>
              </item>
            </commodities>
          </stream>
          <stream>
            <info>
              <mixing_ratio>0.00452453985</mixing_ratio>
              <buf_size>1e100</buf_size>
            </info>
            <commodities>
              <item>
                <commodity>lwr_np</commodity>
                <pref>1.0</pref>
              </item>
              <item>
                <commodity>salt_np</commodity>
                <pref>2.0</pref>
              </item>
            </commodities>
          </stream>
          <stream>
            <info>
              <mixing_ratio>0.00195838076</mixing_ratio>
              <buf_size>1e100</buf_size>
            </info>
            <commodities>
              <item>
                <commodity>lwr_am</commodity>
                <pref>1.0</pref>
              </item>
              <item>
                <commodity>salt_am</commodity>
                <pref>2.0</pref>
              </item>
            </commodities>
          </stream>
          <stream>
            <info>
              <mixing_ratio>0.00088198336</mixing_ratio>
              <buf_size>1e100</buf_size>
            </info>
            <commodities>
              <item>
                <commodity>lwr_cm</commodity>
                <pref>1.0</pref>
              </item>
              <item>
                <commodity>salt_cm</commodity>
                <pref>2.0</pref>
              </item>
            </commodities>
          </stream>
          <stream>
            <info>
              <mixing_ratio>0.08827330133</mixing_ratio>
              <buf_size>1e100</buf_size>
            </info>
            <commodities>
              <item>
                <commodity>lwr_pu</commodity>
                <pref>1.0</pref>
              </item>
              <item>
                <commodity>salt_pu</commodity>
                <pref>2.0</pref>
              </item>
            </commodities>
          </stream>
        </in_streams>
        <out_commod>init_fuel</out_commod>
        <out_buf_size>1e100</out_buf_size>
        <throughput>1e100</throughput>
      </Mixer>
    </config>
</facility>



 <facility>
    <!-- us -->
    <!-- PWR -->
    <name>lwr</name>
    <config>
      <Reactor>
        <fuel_inrecipes>  <val>uox_fuel_recipe</val>       </fuel_inrecipes>
        <fuel_outrecipes> <val>uox_used_fuel_recipe</val>  </fuel_outrecipes>
        <fuel_incommods>  <val>uox</val>                   </fuel_incommods>
        <fuel_outcommods> <val>uox_waste</val>             </fuel_outcommods>
        <cycle_time>18</cycle_time>
        <refuel_time>1</refuel_time>
        <assem_size>29565</assem_size>
        <n_assem_core>3</n_assem_core>
        <n_assem_batch>1</n_assem_batch>
        <power_cap>1110</power_cap>
      </Reactor>
    </config>
  </facility>

   <facility>
    <!-- us -->
    <!-- PWR -->
    <name>fake_rebus</name>
    <config>
      <Reactor>
        <fuel_inrecipes>  <val>uox_fuel_recipe</val>       </fuel_inrecipes>
        <fuel_outrecipes> <val>uox_used_fuel_recipe</val>  </fuel_outrecipes>
        <fuel_incommods>  <val>uox</val>                   </fuel_incommods>
        <fuel_outcommods> <val>uox_waste</val>             </fuel_outcommods>
        <cycle_time>18</cycle_time>
        <refuel_time>1</refuel_time>
        <assem_size>29565</assem_size>
        <n_assem_core>3</n_assem_core>
        <n_assem_batch>1</n_assem_batch>
        <power_cap>1628</power_cap>
      </Reactor>
    </config>
  </facility>


<facility>
  <name>rebus</name>
  <config>
    <saltproc_reactor>
      <init_fuel_commod>init_fuel</init_fuel_commod>
      <final_fuel_commod>fuel_out</final_fuel_commod>
      <fill_commod>dep_u</fill_commod>
      <fissile_out_commod>fissile_out</fissile_out_commod>
      <waste_commod>waste</waste_commod>
      <db_path>./30_rebus_tru.hdf5</db_path>
      <power_cap>1628</power_cap>
    </saltproc_reactor>
  </config>
</facility>

<facility>
        <!-- Stores uox unf for 48 months (4years) -->
    <name>uox_storage</name>
    <config>
        <Storage>
            <in_commods>
                <val>uox_waste</val>
            </in_commods>
            <residence_time>72</residence_time>
            <out_commods>
                <val>cooled_uox</val>
            </out_commods>
        </Storage>
    </config>
</facility>


  <facility>
    <name>enrichment</name>
    <config>
      <Enrichment>
        <feed_commod>natl_u</feed_commod>
        <feed_recipe>natl_u_recipe</feed_recipe>
        <product_commod>uox</product_commod>
        <tails_assay>0.003</tails_assay>
        <tails_commod>tailings</tails_commod>
        <swu_capacity>1e100</swu_capacity>
        <initial_feed>1e100</initial_feed>
      </Enrichment>
    </config>
  </facility>


  <facility>
    <name>nat_u_source</name>
    <config>
        <Source>
        <outcommod>natl_u</outcommod>
        <outrecipe>natl_u_recipe</outrecipe>
        <throughput>1e100</throughput>
      </Source>
    </config>
  </facility>

<facility>
  <name>tails_storage</name>
  <config>
    <Storage>
      <in_commods>
        <val>tailings</val>
      </in_commods>
      <out_commods>
        <val>dep_u</val>
      </out_commods>
    </Storage>
  </config>
</facility>


  <facility>
    <name>unf_source</name>
    <config>
      <Source>
        <outcommod>pre_2013_unf</outcommod>
        <outrecipe>udb_precise</outrecipe>
        <throughput>1e100</throughput>
        <inventory_size>68072030</inventory_size>
      </Source>
    </config>
  </facility>

  <facility>
  <name>fill_commod_source</name>
  <config>
    <Source>
      <outcommod>dep_u</outcommod>
      <outrecipe>depleted_u</outrecipe>
      <throughput>1e100</throughput>
    </Source>
  </config>
</facility>

  <facility>
    <name>SomeSink</name>
    <config>
      <Sink>
        <in_commods>
          <val>waste</val>
          <val>fissile_out</val>
          <val>reprocess_waste</val>
          <val>salt_reprocess_waste</val>
          <val>lwr_u</val>
          <val>salt_u</val>
        </in_commods>
        <capacity>1e100</capacity>
      </Sink>
    </config>
  </facility>

  <facility>
    <name>na_source</name>
    <config>
      <Source>
        <outcommod>na</outcommod>
        <outrecipe>na_recipe</outrecipe>
        <throughput>1e100</throughput>
      </Source>
    </config>
  </facility>

<facility>
  <name>cl_source</name>
  <config>
    <Source>
      <outcommod>cl</outcommod>
      <outrecipe>cl_recipe</outrecipe>
      <throughput>1e100</throughput>
    </Source>
  </config>
</facility>

<facility>
  <name>na_source2</name>
  <config>
    <Source>
      <outcommod>na2</outcommod>
      <outrecipe>na_recipe</outrecipe>
      <throughput>1e100</throughput>
    </Source>
  </config>
</facility>

<facility>
  <name>cl_source2</name>
  <config>
    <Source>
      <outcommod>cl2</outcommod>
      <outrecipe>cl_recipe</outrecipe>
      <throughput>1e100</throughput>
    </Source>
  </config>
</facility>

<facility>
  <name>init_fuel_source</name>
  <config>
    <Source>
      <outcommod>init_fuel</outcommod>
      <outrecipe>init_salt_recipe</outrecipe>
      <throughput>1e100</throughput>
    </Source>
  </config>
</facility>

  <xi:include href='./reactor_with_coordinates.xml' xpointer='xpointer(/root/facility)'/>

  <region>
    <name>us</name>
    <config><NullRegion/></config>
    <institution>
      <name>us_government</name>
      <config>
        <DeployInst>
            <xi:include href='./depinst.xml' xpointer='xpointer(/root/prototypes)'/>
            <xi:include href='./depinst.xml' xpointer='xpointer(/root/build_times)'/>
            <xi:include href='./depinst.xml' xpointer='xpointer(/root/n_build)'/>
            <xi:include href='./depinst.xml' xpointer='xpointer(/root/lifetimes)'/>
        </DeployInst>
      </config>
    </institution>

    <institution>
    <name>lwr_inst</name>
    <config>
      <DeployInst>
        <xi:include href='./lwr_dep.xml' xpointer='xpointer(/root/prototypes)'/>
        <xi:include href='./lwr_dep.xml' xpointer='xpointer(/root/build_times)'/>
        <xi:include href='./lwr_dep.xml' xpointer='xpointer(/root/n_build)'/>
        <xi:include href='./lwr_dep.xml' xpointer='xpointer(/root/lifetimes)'/>
      </DeployInst>
    </config>
  </institution>

  <institution>
  <name>rebus_inst</name>
    <config>
    <DeployInst>
      <xi:include href='./rebus_dep_fourty.xml' xpointer='xpointer(/root/prototypes)'/>
      <xi:include href='./rebus_dep_fourty.xml' xpointer='xpointer(/root/build_times)'/>
      <xi:include href='./rebus_dep_fourty.xml' xpointer='xpointer(/root/n_build)'/>
      <xi:include href='./rebus_dep_fourty.xml' xpointer='xpointer(/root/lifetimes)'/>
    </DeployInst>
    </config>
  </institution>

 </region>


<region>
    <name>Sink_Source</name>
    <config><NullRegion/></config>
        <institution>
         <name>Sink_Source_Inst</name>
         <config><NullInst/></config>
        <initialfacilitylist>
          <entry>
            <number>1</number>
            <prototype>nat_u_source</prototype>
          </entry>
          
          <entry>
            <number>1</number>
            <prototype>enrichment</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>SomeSink</prototype>
          </entry>


          <entry>
            <number>1</number>
            <prototype>salt_reprocessing</prototype>
          </entry>

          
          <entry>
            <number>1</number>
            <prototype>reprocessing</prototype>
          </entry>

          <entry>
            <number>1</number>
            <prototype>rebus_fuel_fab_lwr</prototype>
          </entry>

          <entry>
            <number>1</number>
            <prototype>uox_storage</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>unf_source</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>tails_storage</prototype>
          </entry>

<!--
          <entry>
            <number>1</number>
            <prototype>init_fuel_source</prototype>
          </entry>

          <entry>
            <number>1</number>
            <prototype>fill_commod_source</prototype>
          </entry>
-->
          <entry>
            <number>1</number>
            <prototype>cl_source</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>na_source</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>cl_source2</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>na_source2</prototype>
          </entry>

        </initialfacilitylist>
        </institution>
</region>
<xi:include href='recipes.xml' xpointer='xpointer(/root/recipe)'/>
</simulation>