
<simulation xmlns:xi="http://www.w3.org/2001/XInclude">
  <control>
    <duration>1200</duration>
    <startmonth>5</startmonth>
    <startyear>2013</startyear>
    <solver>coin-or</solver>
    <decay>lazy</decay>
  </control>

  <archetypes>
    <spec>
      <lib>cycamore</lib>
      <name>Source</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Sink</name>
    </spec>
    <spec>
        <lib>cycamore</lib>
        <name>Reactor</name>
    </spec>
    <spec>
      <lib>agents</lib>
      <name>NullRegion</name>
    </spec>
    <spec>
      <lib>agents</lib>
      <name>NullInst</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Separations</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>DeployInst</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Separations</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Enrichment</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Mixer</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Storage</name>
    </spec>
    <spec>
      <lib>recycle</lib>
      <name>Corrm</name>
    </spec>
  </archetypes>



<!-- Infinite UOX_Pu to MOX mixer -->
<facility>
    <name>msr_fuel_mixer</name>
    <config>
      <Mixer>
        <in_streams>
          <stream>
            <info>
              <mixing_ratio>0.13</mixing_ratio>
              <buf_size>1e100</buf_size>
            </info>
            <commodities>
              <item>
                <commodity>na</commodity>
                <pref>1.0</pref>
              </item>
              <item>
                <commodity>rep_na</commodity>
                <pref>1.0</pref>
              </item>
            </commodities>
          </stream>
          <stream>
            <info>
              <mixing_ratio>0.26</mixing_ratio>
              <buf_size>1e100</buf_size>
            </info>
            <commodities>
              <item>
                <commodity>cl</commodity>
                <pref>1.0</pref>
              </item>
              <item>
                <commodity>rep_cl</commodity>
                <pref>1.0</pref>
              </item>
            </commodities>
          </stream>
          <stream>
            <info>
              <mixing_ratio>0.55</mixing_ratio>
              <buf_size>1e100</buf_size>
            </info>
            <commodities>
              <item>
                <commodity>u</commodity>
                <pref>1.0</pref>
              </item>
              <item>
                <commodity>rep_u</commodity>
                <pref>4.0</pref>
              </item>
              
            </commodities>
          </stream>
          <stream>
            <info>
              <mixing_ratio>0.06</mixing_ratio>
              <buf_size>1e100</buf_size>
            </info>
            <commodities>
              <item>
                <commodity>pu</commodity>
                <pref>4.0</pref>
              </item>
              <item>
                <commodity>rep_pu</commodity>
                <pref>4.0</pref>
              </item>
              <item>
              	<commodity>source_pu</commodity>
              	<pref>1.0</pref>
              </item>
            </commodities>
          </stream>
        </in_streams>
        <out_commod>msr_fuel</out_commod>
        <out_buf_size>1e100</out_buf_size>
        <throughput>1e100</throughput>
      </Mixer>
    </config>
</facility>


  <facility>
    <name>sfr_reprocessing</name>
    <config>
      <Separations>
         <feed_commods>   <val>cooled_sfr</val> <val>cooled_blanket</val> </feed_commods>
         <feed_commod_prefs> <val>1.0</val> <val>1.0</val>  </feed_commod_prefs>
         <feed_recipe>driver_used</feed_recipe>
         <feedbuf_size>1e100</feedbuf_size>
         <!-- 1100 tons/year 91.6 tons/timestep -->
         <throughput>1e100</throughput>
         <leftover_commod>reprocess_waste</leftover_commod>
         <leftoverbuf_size>1e100</leftoverbuf_size>
         <streams>
          <item>
            <commod>sfr_pu</commod>
            <info>
              <buf_size>1e100</buf_size>
              <efficiencies>
                <item>
                  <comp>Pu</comp> <eff>.99</eff>
                </item>
                </efficiencies>
            </info>
          </item>
          <item>
            <commod>sfr_u</commod>
            <info>
              <buf_size>1e100</buf_size>
              <efficiencies>
                <item>
                  <comp>U</comp> <eff>.99</eff>
                </item>
                </efficiencies>
            </info>
          </item>
        </streams>
      </Separations>
    </config>
  </facility>

<facility>
    <name>sfr_fuel_mixer</name>
    <config>
      <Mixer>
        <in_streams>
          
          <stream>
            <info>
              <mixing_ratio>0.85</mixing_ratio>
              <buf_size>1e100</buf_size>
            </info>
            <commodities>
              <item>
                <commodity>u</commodity>
                <pref>1.0</pref>
              </item>
              <item>
                <commodity>rep_u</commodity>
                <pref>4.0</pref>
              </item>
              <item>
                <commodity>dep_u</commodity>
                <pref>4.0</pref>
              </item>
              
            </commodities>
          </stream>
          <stream>
            <info>
              <mixing_ratio>0.15</mixing_ratio>
              <buf_size>1e100</buf_size>
            </info>
            <commodities>
              <item>
                <commodity>pu</commodity>
                <pref>4.0</pref>
              </item>
              <item>
                <commodity>rep_pu</commodity>
                <pref>4.0</pref>
              </item>
              <item>
                <commodity>source_pu</commodity>
                <pref>1.0</pref>
              </item>
            </commodities>
          </stream>
        </in_streams>
        <out_commod>sfr_fuel</out_commod>
        <out_buf_size>1e100</out_buf_size>
        <throughput>1e100</throughput>
      </Mixer>
    </config>
</facility>

<facility>
    <name>msr_reprocessing</name>
    <config>
      <Separations>
         <feed_commods>   <val>msr_used</val> </feed_commods>
         <feed_commod_prefs> <val>1.0</val> <val>1.0</val> </feed_commod_prefs>
         <feed_recipe>msr_output_recipe</feed_recipe>
         <feedbuf_size>1e100</feedbuf_size>
         <!-- 1100 tons/year 91.6 tons/timestep -->
         <throughput>1e100</throughput>
         <leftover_commod>reprocess_waste</leftover_commod>
         <leftoverbuf_size>1e100</leftoverbuf_size>
         <streams>
          <item>
            <commod>rep_pu</commod>
            <info>
              <buf_size>1e100</buf_size>
              <efficiencies>
                <item>
                  <comp>Pu</comp> <eff>.99</eff>
                </item>
                </efficiencies>
            </info>
          </item>
          <item>
            <commod>rep_u</commod>
            <info>
              <buf_size>1e100</buf_size>
              <efficiencies>
                <item>
                  <comp>U</comp> <eff>.99</eff>
                </item>
                </efficiencies>
            </info>
          </item>
          <item>
            <commod>rep_na</commod>
            <info>
              <buf_size>1e100</buf_size>
              <efficiencies>
                <item>
                  <comp>Na</comp> <eff>.99</eff>
                </item>
                </efficiencies>
            </info>
          </item>
          <item>
            <commod>rep_cl</commod>
            <info>
              <buf_size>1e100</buf_size>
              <efficiencies>
                <item>
                  <comp>Cl</comp> <eff>.99</eff>
                </item>
                </efficiencies>
            </info>
          </item>
        </streams>
      </Separations>
    </config>
  </facility>



  <facility>
    <name>msr</name>
    <!-- 26.4 tons of HM initial loading -->
    <!-- 61% of total mass is fuel salt -->
    <!-- total core mass is ~43.3 tons -->
    <config>
      <Corrm>
        <init_fuel_commod>msr_fuel</init_fuel_commod>
        <core_size>43300</core_size>
        <init_fuel_recipe>msr_input_recipe</init_fuel_recipe>

        <fill_commod>fill</fill_commod>
        <fill_recipe>depleted_u</fill_recipe>
        <!--1190 kg/year DU feed -> 100kg/month -->
        <fill_per_timestep>100</fill_per_timestep>


        <discharge_fuel_commod>msr_used</discharge_fuel_commod>
        <!-- output amount same as core size-->
        <discharge_fuel_recipe>msr_output_recipe</discharge_fuel_recipe>

        <power_cap>820</power_cap>

        <fissile_out_commod>pu</fissile_out_commod>
        <fissile_out_recipe>msr_pu_recipe</fissile_out_recipe>
        <!-- 330 kg /year PU removal -> 27.5 kg/month --> 
        <fissile_output_per_timestep>27.5</fissile_output_per_timestep>

        <waste_commod>waste</waste_commod>
        <waste_recipe>waste_recipe</waste_recipe>
        <!-- Waste currently not defined -->
        <waste_output_per_timestep>1</waste_output_per_timestep>
      </Corrm>
    </config>
  </facility>


<facility>
    <name>sfr</name>
    <!-- sfr and blanket from TK Kim -->
    <!-- Advanced burner reactor, metal fuel -->
    <!-- High TRU conversion ratio -->
    <config>
      <Reactor>
        <fuel_inrecipes>  <val>driver_fresh</val>      <val>driver_fresh</val>  </fuel_inrecipes>
        <fuel_outrecipes> <val>driver_used</val> <val>driver_used</val>  </fuel_outrecipes>
        <fuel_incommods>  <val>sfr_fuel_legacy</val> <val>sfr_fuel_new</val>                   </fuel_incommods>
        <fuel_outcommods> <val>sfr_used</val> <val>sfr_used</val>             </fuel_outcommods>
        <fuel_prefs>      <val>1.0</val> <val>3.0</val>                   </fuel_prefs>
        <cycle_time>9</cycle_time>
        <refuel_time>1</refuel_time>
        <assem_size>3076</assem_size>
        <n_assem_core>5</n_assem_core>
        <n_assem_batch>1</n_assem_batch>
        <power_cap>400</power_cap>
      </Reactor>
    </config>
</facility>

<facility>
    <name>blanket</name>
    <config>
      <Reactor>
        <fuel_inrecipes>  <val>natl_u_recipe</val>        </fuel_inrecipes>
        <fuel_outrecipes> <val>blanket_used</val>   </fuel_outrecipes>
        <fuel_incommods>  <val>blanket</val>                    </fuel_incommods>
        <fuel_outcommods> <val>blanket_used</val>              </fuel_outcommods>
        <fuel_prefs>      <val>1.0</val>                    </fuel_prefs>
        <cycle_time>14</cycle_time>
        <refuel_time>1</refuel_time>
        <assem_size>768</assem_size>
        <n_assem_core>5</n_assem_core>
        <n_assem_batch>1</n_assem_batch>
        <power_cap>0</power_cap>
      </Reactor>
    </config>
</facility>


<facility>
        <!-- Stores uox unf for 48 months (4years) -->
    <name>sfr_storage</name>
    <config>
        <Storage>
            <in_commods>
                <val>sfr_used</val>
            </in_commods>
            <residence_time>36</residence_time>
            <out_commods>
                <val>cooled_sfr</val>
            </out_commods>
        </Storage>
    </config>
</facility>

<facility>
        <!-- Stores uox unf for 48 months (4years) -->
    <name>blanket_storage</name>
    <config>
        <Storage>
            <in_commods>
                <val>blanket_used</val>
            </in_commods>
            <residence_time>12</residence_time>
            <out_commods>
                <val>cooled_blanket</val>
            </out_commods>
        </Storage>
    </config>
</facility>


  <facility>
    <name>dep_u_source</name>
    <config>
      <Source>
        <outcommod>dep_u</outcommod>
        <outrecipe>depleted_u</outrecipe>
        <throughput>1e10</throughput>
      </Source>
    </config>
  </facility>


  <facility>
    <name>pu_source</name>
    <config>
      <Source>
        <outcommod>pu</outcommod>
        <outrecipe>pu</outrecipe>
        <throughput>1e10</throughput>
      </Source>
    </config>
  </facility>


  <facility>
    <name>blanket_source</name>
    <config>
      <Source>
        <outcommod>blanket</outcommod>
        <outrecipe>depleted_u</outrecipe>
        <throughput>1e10</throughput>
      </Source>
    </config>
  </facility>


  <facility>
    <name>na_source</name>
    <config>
      <Source>
        <outcommod>na</outcommod>
        <outrecipe>na</outrecipe>
        <throughput>1e10</throughput>
      </Source>
    </config>
  </facility>

  <facility>
    <name>cl_source</name>
    <config>
      <Source>
        <outcommod>cl</outcommod>
        <outrecipe>cl</outrecipe>
        <throughput>1e10</throughput>
      </Source>
    </config>
  </facility>

  <facility>
    <name>u_source</name>
    <config>
      <Source>
        <outcommod>u</outcommod>
        <outrecipe>depleted_u</outrecipe>
        <throughput>1e10</throughput>
      </Source>
    </config>
  </facility>


  <facility>
    <name>fill_source</name>
    <config>
      <Source>
        <outcommod>fill</outcommod>
        <outrecipe>depleted_u</outrecipe>
        <throughput>1e10</throughput>
      </Source>
    </config>
  </facility>

  <facility>
    <name>final_sink</name>
    <config>
      <Sink>
        <in_commods>
          <val>waste</val>
          <val>reprocess_waste</val>
        </in_commods>
        <capacity>1e100</capacity>
      </Sink>
    </config>
  </facility>

  <region>
    <name>us</name>
    <config><NullRegion/></config>
    <institution>
      <name>oneinst</name>
      <config>
        <DeployInst>
          <prototypes>
            <val>msr</val>
            <val>msr</val>
            <val>msr</val>
            <val>msr</val>
            <val>msr</val>
            <val>msr</val>

            <val>sfr</val>
            <val>blanket</val>
            <val>sfr</val>
            <val>blanket</val>
          </prototypes>
          <build_times>
            <val>1</val>
            <val>241</val>
            <val>481</val>
            <val>721</val>
            <val>961</val>
            <val>1201</val>

            <val>1</val>
            <val>961</val>
            <val>1</val>
            <val>961</val>

          </build_times>
          <n_build>
            <val>61</val>
            <val>61</val>
            <val>61</val>
            <val>61</val>
            <val>61</val>
            <val>61</val>

            <val>125</val>
            <val>125</val>
            <val>125</val>
            <val>125</val>

          </n_build>
          <lifetimes>
            <val>240</val>
            <val>240</val>
            <val>240</val>
            <val>240</val>
            <val>240</val>
            <val>240</val>

            <val>960</val>
            <val>960</val>
            <val>960</val>
            <val>960</val>
          </lifetimes>
        </DeployInst>
      </config>
    </institution>
  </region>

  
<region>
    <name>Sink_Source</name>
    <config><NullRegion/></config>
        <institution>
         <name>Sink_Source_Inst</name>
         <config><NullInst/></config>
        <initialfacilitylist>
          <entry>
            <number>1</number>
            <prototype>na_source</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>cl_source</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>final_sink</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>msr_reprocessing</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>sfr_reprocessing</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>msr_fuel_mixer</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>sfr_fuel_mixer</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>pu_source</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>u_source</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>fill_source</prototype>
          </entry>


          <entry>
            <number>1</number>
            <prototype>sfr_storage</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>blanket_storage</prototype>
          </entry>

          <entry>
            <number>1</number>
            <prototype>dep_u_source</prototype>
          </entry>
          <entry>
            <number>1</number>
            <prototype>pu_source</prototype>
          </entry>

          <entry>
            <number>1</number>
            <prototype>blanket_source</prototype>
          </entry>



        </initialfacilitylist>
        </institution>
</region>
<xi:include href='./recipes.xml' xpointer='xpointer(/root/recipe)'/>
</simulation>